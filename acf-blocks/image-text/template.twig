{# components/image-text.twig #}
{% set image           = fields.image %}
{% set imagePosition   = fields.image_position ?? 'right' %}
{% set title           = fields.title %}
{% set paragraph       = fields.paragraph %}
{% set button_text     = fields.button_text %}
{% set button_url      = fields.button_url %}
{% set open_in_new_tab = fields.open_in_new_tab %}

{# donn√©es image #}
{% set imgUrl    = image.url ?? image %}
{% set imgAlt    = (image.alt ?? title ?? '')|trim %}
{% set imgId     = image.id ?? image.ID ?? null %}
{% set imgSrcset = imgId ? function('wp_get_attachment_image_srcset', imgId, 'full') : null %}
{% set imgSizes  = '(min-width: 1024px) 50vw, 90vw' %}
{% set fetchprio = fields.is_lcp ? 'high' : 'auto' %}

<section class="py-16 md:py-24">
	<div class="container mx-auto px-4 md:px-6 max-w-7xl">
		<div class="grid items-center gap-6 md:gap-12 md:grid-cols-12">
			<div class="{{ imagePosition == 'right' ? 'md:col-span-6' : 'md:col-span-6 md:order-2' }}">
				{% if imgId %}
					{{ function(
                        'wp_get_attachment_image',
                        imgId,
                        'large',
                        false,
                        {
                            class: 'w-full h-auto object-cover',
                            alt:   imgAlt|default('')
                        }
                    ) }}
				{% elseif imgUrl %}
					<figure class="w-full">
						<div class="relative overflow-hidden rounded-xl">
							<img src="{{ imgUrl }}" {% if imgSrcset %} srcset="{{ imgSrcset }}" {% endif %} sizes="{{ imgSizes }}" alt="{{ imgAlt|e }}" class="w-full h-auto object-cover" loading="lazy" decoding="async" fetchpriority="{{ fetchprio }}">
						</div>
					</figure>
				{% endif %}
			</div>
			<div class="{{ imagePosition == 'right' ? 'md:col-span-6' : 'md:col-span-6 md:order-1' }}">
				{% if title %}
					<h2 class="text-3xl md:text-4xl font-bold tracking-tight mb-8 text-gray-900">
						{{ title }}
					</h2>
				{% endif %}

				{% if paragraph %}
					<p class="text-base md:text-lg text-gray-600 leading-relaxed mb-6">
						{{ paragraph|nl2br }}
					</p>
				{% endif %}

				{% if button_text %}
					<div class="flex justify-center md:justify-start">
						{% include 'components/button.twig' with {
                            button_text:      button_text,
                            button_url:       button_url,
                            open_in_new_tab:  open_in_new_tab,
                            variant:          'outline'
                        } %}
					</div>
				{% endif %}
			</div>
		</div>
	</div>
</section>
